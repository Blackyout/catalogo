<!--
var g_bShowApiErrors=true,g_strAPINotFound="Management system interface not found.",g_strAPITooDeep="Cannot find API - too deeply nested.",g_strAPIInitFailed="Found API but LMSInitialize failed.",g_strAPISetError="Trying to set value but API not available.",g_bMasteryScoreInitialized=false,g_nFindAPITries=0,g_objAPI=null,g_bInitDone=false,g_bFinishDone=false;var	g_bSCOBrowse=false;var g_dtmInitialized=new Date();function AlertUserOfAPIError(strText){if(g_bShowApiErrors)alert(strText)};function FindAPI(win){while((win.API==null)&&(win.parent!=null)&&(win.parent!=win)){g_nFindAPITries++;if(g_nFindAPITries>500){AlertUserOfAPIError(g_strAPITooDeep);return null;};win=win.parent;};return win.API;};function APIOK(){return((typeof(g_objAPI)!="undefined")&&(g_objAPI!=null))};function SCOInitialize(){var err=true;if(!g_bInitDone){if((window.parent)&&(window.parent!=window)){g_objAPI=FindAPI(window.parent)};if((g_objAPI==null)&&(window.opener!=null)){g_objAPI=FindAPI(window.opener)};if(!APIOK()){AlertUserOfAPIError(g_strAPINotFound);err=false}else{err=g_objAPI.LMSInitialize("");if(err=="true"){g_bSCOBrowse=(g_objAPI.LMSGetValue("cmi.core.lesson_mode")=="browse");if(!g_bSCOBrowse){if(g_objAPI.LMSGetValue("cmi.core.lesson_status")=="not attempted"){err=g_objAPI.LMSSetValue("cmi.core.lesson_status","incomplete")};};}else{AlertUserOfAPIError(g_strAPIInitFailed)};};};if(typeof(SCOInitData)!="undefined"){SCOInitData()};g_dtmInitialized=new Date();return(err+"")};function SCOFinish(){if((APIOK())&&(g_bFinishDone==false)){if(typeof(SCOSaveData)!="undefined"){SCOReportSessionTime();SCOSaveData();};g_bFinishDone=(g_objAPI.LMSFinish("")=="true");};return(g_bFinishDone+"")};function SCOGetValue(nam){return((APIOK())?g_objAPI.LMSGetValue(nam.toString()):"")};function SCOCommit(parm){return((APIOK())?g_objAPI.LMSCommit(""):"false")};function SCOGetLastError(parm){return((APIOK())?g_objAPI.LMSGetLastError(""):"-1")};function SCOGetErrorString(n){return((APIOK())?g_objAPI.LMSGetErrorString(n):"No API")};function SCOGetDiagnostic(p){return((APIOK())?g_objAPI.LMSGetDiagnostic(p):"No API")};var g_bMinScoreAcquired=false,g_bMaxScoreAcquired=false;function SCOSetValue(nam,val){var err="";if(!APIOK()){AlertUserOfAPIError(g_strAPISetError+"\n"+nam+"\n"+val);err="false"}else if(nam=="cmi.core.score.raw")err=privReportRawScore(val);if(err==""){err=g_objAPI.LMSSetValue(nam,val.toString()+"");if(err!="true")return err};if(nam=="cmi.core.score.min"){g_bMinScoreAcquired=true;g_nSCO_ScoreMin=val}else if(nam=="cmi.core.score.max"){g_bMaxScoreAcquired=true;g_nSCO_ScoreMax=val};return err};function privReportRawScore(nRaw){if(isNaN(nRaw))return"false";if(!g_bMinScoreAcquired){if(g_objAPI.LMSSetValue("cmi.core.score.min",g_nSCO_ScoreMin+"")!="true")return"false"};if(!g_bMaxScoreAcquired){if(g_objAPI.LMSSetValue("cmi.core.score.max",g_nSCO_ScoreMax+"")!="true")return"false"};if(g_objAPI.LMSSetValue("cmi.core.score.raw",nRaw)!="true")return"false";g_bMinScoreAcquired=false;g_bMaxScoreAcquired=false;if(!g_bMasteryScoreInitialized){var nMasteryScore=parseInt(SCOGetValue("cmi.student_data.mastery_score"),10);if(!isNaN(nMasteryScore))g_SCO_MasteryScore=nMasteryScore};if(isNaN(g_SCO_MasteryScore))return"false";var stat=(nRaw>=g_SCO_MasteryScore?"passed":"failed");if(SCOSetValue("cmi.core.lesson_status",stat)!="true")return"false";return"true"};function MillisecondsToCMIDuration(n){var hms="",dtm=new Date();dtm.setTime(n);var h="000"+Math.floor(n/3600000),m="0"+dtm.getMinutes(),s="0"+dtm.getSeconds(),cs="0"+Math.round(dtm.getMilliseconds()/10);hms=h.substr(h.length-4)+":"+m.substr(m.length-2)+":";hms+=s.substr(s.length-2)+"."+cs.substr(cs.length-2);return hms};function SCOReportSessionTime(){var dtm=new Date(),n=dtm.getTime()-g_dtmInitialized.getTime();return SCOSetValue("cmi.core.session_time",MillisecondsToCMIDuration(n))};function SCOSetStatusCompleted(){var stat=SCOGetValue("cmi.core.lesson_status");if(SCOGetValue("cmi.core.lesson_mode")!="browse"){if((stat!="completed")&&(stat!="passed")&&(stat!="failed")){return SCOSetValue("cmi.core.lesson_status","completed")};}else return"false"};function GoToPage(n){if((!isNaN(n))&&(n>=1)&&(n<=znNavigablePages)){if(n<10){cg_stage.location.href="page_0"+n+".htm"};if(n>=10){cg_stage.location.href="page_"+n+".htm"};}else if((!isNaN(n))&&(n==0)){cg_stage.location.href="index.htm";};};function SetThisPage(n){var i=0,nCnt=0;znThisPage=n;zaVisitedPages[n]=true;for(i=1;i<znNavigablePages+1;i++){if(zaVisitedPages[i]){nCnt++};};zaSuspendData=zaVisitedPages.join(",");znSuspendLocation=znThisPage;if(nCnt==znNavigablePages){SCOSetStatusCompleted();zaSuspendStatus="";znSuspendLocation="";zaSuspendData="";};SCOSetValue("cmi.core.exit",zaSuspendStatus);SCOSetValue("cmi.core.lesson_location",znSuspendLocation);SCOSetValue("cmi.suspend_data",zaSuspendData);SCOCommit();};function SCOInitData(){var loc=znStartPage;if((SCOGetValue("cmi.core.entry")!="ab-initio")&&(SCOGetValue("cmi.core.lesson_status")!="completed")){var SuspendData=SCOGetValue("cmi.suspend_data");if(SuspendData.length>0){zaVisitedPages=SuspendData.split(",")};var loc=(parseInt(SCOGetValue("cmi.core.lesson_location")));if(isNaN(loc)){loc=znStartPage;};};GoToPage(loc);};function SCOSaveData(){SCOSetValue("cmi.core.exit",zaSuspendStatus);SCOSetValue("cmi.core.lesson_location",znSuspendLocation);SCOSetValue("cmi.suspend_data",zaSuspendData);SCOCommit();};function initArray(anArray,aValue){for(var i=0;i<anArray.length;i++){anArray[i]=aValue;};};function storeScore(q,s){znQuestionScores[q]=s;var t=sumScores(znQuestionScores);SCOSetValue("cmi.core.score.raw",t);SCOCommit();};function sumScores(scoreArray){var sum=0;for(var i=0;i<scoreArray.length;i++){sum=sum+scoreArray[i];};return sum;};
// -->